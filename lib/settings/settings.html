<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Koteky</title>
    <link rel="stylesheet" href="../../node_modules/bootstrap/dist/css/bootstrap.min.css">
    <script>
    window.$ = window.jQuery = require('jquery');
    window.$ = window.bootstrap = require('bootstrap');
    require('electron-stylus')(__dirname + '/../../style/index.styl');
    </script>
  </head>
  <body>
        <div id="plugins">
            <template v-for="plugin in all">
                <plugin :context="plugin" />
            </template>
        </div>
        <script type="text/javascript">
            var pluginsViewModel = require('./plugins-view-model');
            var pluginsModel = require('./plugins-model');
            const path = require('path');
            const fs = require('fs');

            var pathto = path.join(__dirname, '/../../package.json');
            fs.openSync(pathto, 'r+');
            var data=fs.readFileSync(pathto);
            var packageJson = JSON.parse(data);
            var installed = packageJson.plugins;
            var all = [{ name: "koteky-twitter", version: "^0.3.0" }]

            var update = (pluginSection) =>
            {
                packageJson.plugins = pluginSection;
                fs.writeFileSync(pathto, JSON.stringify(packageJson));
            }

            var pluginsM = new pluginsModel(all, installed, update);
            var pluginsVM = new pluginsViewModel(window, pluginsM);
        </script>
    </body>
</html>
